import{R as p,u as v,U as I,y as f,j as l,L as x,E as P,t as E,F as N,V as k}from"./index-DgChYpsb.js";import{h as A}from"./index-D2FXBcfJ.js";import{I as D}from"./index-CrudAHUQ.js";import"./EyeOutlined-Cm8LOwQp.js";import"./addEventListener-Dj6lacZr.js";import"./index-wIlz5b4F.js";import"./fade-BLp5ZxV7.js";function M(t,n){if(t==null)return{};var e=G(t,n),o,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)o=s[r],!(n.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(t,o)&&(e[o]=t[o])}return e}function G(t,n){if(t==null)return{};var e={},o=Object.keys(t),r,s;for(s=0;s<o.length;s++)r=o[s],!(n.indexOf(r)>=0)&&(e[r]=t[r]);return e}function h(){return h=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},h.apply(this,arguments)}function b(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),e.push.apply(e,o)}return e}function d(t){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?b(Object(e),!0).forEach(function(o){S(t,o,e[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):b(Object(e)).forEach(function(o){Object.defineProperty(t,o,Object.getOwnPropertyDescriptor(e,o))})}return t}function S(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}const L={breakpointCols:void 0,className:void 0,columnClassName:void 0,children:void 0,columnAttrs:void 0,column:void 0},C=2;class w extends p.Component{constructor(n){super(n),this.reCalculateColumnCount=this.reCalculateColumnCount.bind(this),this.reCalculateColumnCountDebounce=this.reCalculateColumnCountDebounce.bind(this);let e;this.props.breakpointCols&&this.props.breakpointCols.default?e=this.props.breakpointCols.default:e=parseInt(this.props.breakpointCols)||C,this.state={columnCount:e}}componentDidMount(){this.reCalculateColumnCount(),window&&window.addEventListener("resize",this.reCalculateColumnCountDebounce)}componentDidUpdate(){this.reCalculateColumnCount()}componentWillUnmount(){window&&window.removeEventListener("resize",this.reCalculateColumnCountDebounce)}reCalculateColumnCountDebounce(){if(!window||!window.requestAnimationFrame){this.reCalculateColumnCount();return}window.cancelAnimationFrame&&window.cancelAnimationFrame(this._lastRecalculateAnimationFrame),this._lastRecalculateAnimationFrame=window.requestAnimationFrame(()=>{this.reCalculateColumnCount()})}reCalculateColumnCount(){const n=window&&window.innerWidth||1/0;let e=this.props.breakpointCols;typeof e!="object"&&(e={default:parseInt(e)||C});let o=1/0,r=e.default||C;for(let s in e){const i=parseInt(s);i>0&&n<=i&&i<o&&(o=i,r=e[s])}r=Math.max(1,parseInt(r)||1),this.state.columnCount!==r&&this.setState({columnCount:r})}itemsInColumns(){const n=this.state.columnCount,e=new Array(n),o=p.Children.toArray(this.props.children);for(let r=0;r<o.length;r++){const s=r%n;e[s]||(e[s]=[]),e[s].push(o[r])}return e}renderColumns(){const{column:n,columnAttrs:e={},columnClassName:o}=this.props,r=this.itemsInColumns(),s=`${100/r.length}%`;let i=o;i&&typeof i!="string"&&(this.logDeprecated('The property "columnClassName" requires a string'),typeof i>"u"&&(i="my-masonry-grid_column"));const u=d(d(d({},n),e),{},{style:d(d({},e.style),{},{width:s}),className:i});return r.map((c,a)=>p.createElement("div",h({},u,{key:a}),c))}logDeprecated(n){console.error("[Masonry]",n)}render(){const n=this.props,{children:e,breakpointCols:o,columnClassName:r,columnAttrs:s,column:i,className:u}=n,c=M(n,["children","breakpointCols","columnClassName","columnAttrs","column","className"]);let a=u;return typeof u!="string"&&(this.logDeprecated('The property "className" requires a string'),typeof u>"u"&&(a="my-masonry-grid")),p.createElement("div",h({},c,{className:a}),this.renderColumns())}}w.defaultProps=L;const q="_photoGallery_mq463_1",F="_loadingContainer_mq463_11",R="_myMasonryGrid_mq463_25",U="_myMasonryGridColumn_mq463_37",W="_imageItem_mq463_47",y={photoGallery:q,loadingContainer:F,myMasonryGrid:R,myMasonryGridColumn:U,imageItem:W},g=10,J=()=>{const{data:t,error:n,isLoading:e}=v("/api/imgs",I),[o,r]=f.useState(0),[s,i]=f.useState([]),u=f.useCallback(()=>{if(!t)return;const a=o+1,m=o*g,j=m+g,O=t.slice(m,j);i(_=>[..._,...O]),r(a)},[t,o]);f.useEffect(()=>{if(!t)return;s.length===0&&i(t.slice(0,g));const a=()=>{document.documentElement.scrollTop===document.documentElement.scrollHeight-(document.documentElement.clientHeight??document.body.clientHeight)&&s.length<t.length&&u()};return window.addEventListener("scroll",a),()=>window.removeEventListener("scroll",a)},[s,t,u]);const c={default:4,1100:3,700:2,500:1};return e?l.jsx(x,{}):n||!t?l.jsx(P,{}):l.jsxs("div",{children:[l.jsx("h1",{children:E`view.photos.title`}),l.jsx(N,{justify:"center",wrap:!0,children:l.jsxs("div",{className:y.photoGallery,children:[l.jsx(w,{breakpointCols:c,className:y.myMasonryGrid,columnClassName:y.myMasonryGridColumn,children:s.map((a,m)=>l.jsx("div",{className:"image-item",children:l.jsx(D,{src:`${new URL(A()).origin}/imgs/${a}`,alt:`Photo ${m+1}`})},Number(m.toString())))}),s.length<t.length&&l.jsx("div",{className:"loading-more",children:l.jsx(k,{})})]})})]})};export{J as default};
